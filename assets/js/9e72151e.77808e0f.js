"use strict";(self.webpackChunkmomento_docs=self.webpackChunkmomento_docs||[]).push([[8099],{5162:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(7294),r=n(6010);const i="tabItem_Ymn6";function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i,o),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>E});var a=n(7462),r=n(7294),i=n(6010),o=n(2466),s=n(6550),l=n(1980),c=n(7392),u=n(12);function p(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function m(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function b(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function d(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=m(e),[o,s]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!b({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[l,c]=d({queryString:n,groupId:a}),[p,h]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,u.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),g=(()=>{const e=l??p;return b({value:e,tabValues:i})?e:null})();(0,r.useLayoutEffect)((()=>{g&&s(g)}),[g]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!b({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),c(e),h(e)}),[c,h,i]),tabValues:i}}var g=n(2389);const f="tabList__CuJ",v="tabItem_LNqP";function k(e){let{className:t,block:n,selectedValue:s,selectValue:l,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),m=e=>{const t=e.currentTarget,n=u.indexOf(t),a=c[n].value;a!==s&&(p(t),l(a))},b=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},c.map((e=>{let{value:t,label:n,attributes:o}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>u.push(e),onKeyDown:b,onClick:m},o,{className:(0,i.Z)("tabs__item",v,o?.className,{"tabs__item--active":s===t})}),n??t)})))}function T(e){let{lazy:t,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function y(e){const t=h(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",f)},r.createElement(k,(0,a.Z)({},e,t)),r.createElement(T,(0,a.Z)({},e,t)))}function E(e){const t=(0,g.Z)();return r.createElement(y,(0,a.Z)({key:String(t)},e))}},3404:(e,t,n)=>{n(7294)},9720:(e,t,n)=>{n.d(t,{X:()=>s});var a=n(4866),r=n(5162),i=n(814),o=n(7294);const s=e=>{let{js:t,python:n,java:s,go:l,csharp:c,php:u,rust:p,ruby:m,elixir:b,cli:d}=e;return t||n||s||l||c||u||p||m||b||d?o.createElement(a.Z,null,t&&o.createElement(r.Z,{value:"js",label:"JavaScript"},o.createElement(i.Z,{language:"js"},t)),n&&o.createElement(r.Z,{value:"python",label:"Python"},o.createElement(i.Z,{language:"python"},n)),s&&o.createElement(r.Z,{value:"java",label:"Java"},o.createElement(i.Z,{language:"java"},s)),l&&o.createElement(r.Z,{value:"go",label:"Go"},o.createElement(i.Z,{language:"go"},l)),c&&o.createElement(r.Z,{value:"csharp",label:"C#"},o.createElement(i.Z,{language:"csharp"},c)),u&&o.createElement(r.Z,{value:"php",label:"PHP"},o.createElement(i.Z,{language:"php"},u)),p&&o.createElement(r.Z,{value:"rust",label:"Rust"},o.createElement(i.Z,{language:"rust"},p)),m&&o.createElement(r.Z,{value:"ruby",label:"Ruby"},o.createElement(i.Z,{language:"ruby"},m)),b&&o.createElement(r.Z,{value:"elixir",label:"Elixir"},o.createElement(i.Z,{language:"elixir"},b)),d&&o.createElement(r.Z,{value:"cli",label:"CLI"},o.createElement(i.Z,{language:"cli"},d))):null}},6146:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=n(7462),r=(n(7294),n(3905)),i=(n(3404),n(9720));const o={sidebar_position:1,sidebar_label:"API Reference",title:"Topics (pub/sub) API reference",description:"Learn how to interact programmatically with Momento Topics pub/sub API."},s="Using the Momento Topics (pub/sub) API",l={unversionedId:"topics/develop/api-reference/index",id:"topics/develop/api-reference/index",title:"Topics (pub/sub) API reference",description:"Learn how to interact programmatically with Momento Topics pub/sub API.",source:"@site/docs/topics/develop/api-reference/index.md",sourceDirName:"topics/develop/api-reference",slug:"/topics/develop/api-reference/",permalink:"/topics/develop/api-reference/",draft:!1,editUrl:"https://github.com/momentohq/public-dev-docs/tree/main/docs/topics/develop/api-reference/index.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"API Reference",title:"Topics (pub/sub) API reference",description:"Learn how to interact programmatically with Momento Topics pub/sub API."},sidebar:"topicsSidebar",previous:{title:"Develop",permalink:"/topics/develop/"},next:{title:"Auth",permalink:"/topics/develop/api-reference/auth"}},c={},u=[{value:"Topics methods",id:"topics-methods",level:2},{value:"Subscribe",id:"subscribe",level:3},{value:"Publish",id:"publish",level:3},{value:"TopicClient",id:"topicclient",level:2},{value:"Example apps using Momento Topics APIs",id:"example-apps-using-momento-topics-apis",level:2}],p=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},m=p("Tabs"),b=p("TabItem"),d={toc:u};function h(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"using-the-momento-topics-pubsub-api"},"Using the Momento Topics (pub/sub) API"),(0,r.kt)("p",null,"Momento Topics is a messaging pattern enabling real-time communication between parts of a distributed application. It enables you to publish (produce) values to a topic and subscribe (consume) from a topic. This page details the Momento API methods for interacting with Momento Topics."),(0,r.kt)("img",{src:"/img/topics-api.jpg",width:"100%",alt:"An image showing the movement of lots of data, messages published, moved to where they need to go quickly and accurately."}),(0,r.kt)("h2",{id:"topics-methods"},"Topics methods"),(0,r.kt)("h3",{id:"subscribe"},"Subscribe"),(0,r.kt)("p",null,"This method subscribes to a topic to receive new values with a stateful connection."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cacheName"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the cache where the topic exists.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"topicName"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the topic to subscribe to.")))),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Method response object"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Success - Returns a subscription object."),(0,r.kt)("li",{parentName:"ul"},"Error")),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/topics/develop/api-reference/response-objects"},"response objects")," for specific information."),(0,r.kt)("p",null,"With the returned subscription object, once put in a for loop, your code will receive an event when a new value is published to the Topic.")),(0,r.kt)(i.X,{js:"const result = await topicClient.subscribe('test-cache', 'test-topic', {\n  onError: () => {\n    return;\n  },\n  onItem: (item: TopicItem) => {\n    console.log(`Publishing values to the topic 'test-topic': ${item.value().toString()}`);\n    return;\n  },\n});\nif (result instanceof TopicSubscribe.Subscription) {\n  console.log(\"Successfully subscribed to topic 'test-topic'\");\n\n  // Publish a value\n  await topicClient.publish('test-cache', 'test-topic', 'test-value');\n\n  // Wait for published values to be received.\n  setTimeout(() => {\n    console.log('Waiting for the published values');\n  }, 2000);\n\n  // Need to close the stream before the example ends or else the example will hang.\n  result.unsubscribe();\n} else if (result instanceof TopicSubscribe.Error) {\n  throw new Error(\n    `An error occurred while attempting to subscribe to the topic 'test-topic' in cache 'test-cache': ${result.errorCode()}: ${result.toString()}`\n  );\n}",python:'subscription = await topic_client.subscribe("cache", "my_topic")\nmatch subscription:\n    case TopicSubscribe.Error():\n        print("Error subscribing to topic: ", subscription.message)\n    case TopicSubscribe.SubscriptionAsync():\n        await topic_client.publish("cache", "my_topic", "my_value")\n        async for item in subscription:\n            match item:\n                case TopicSubscriptionItem.Text():\n                    print(f"Received message as string: {item.value}")\n                    return\n                case TopicSubscriptionItem.Binary():\n                    print(f"Received message as bytes: {item.value}")\n                    return\n                case TopicSubscriptionItem.Error():\n                    print("Error with received message:", item.inner_exception.message)\n                    return',java:"",go:'// Instantiate subscriber\nsub, subErr := client.Subscribe(ctx, &momento.TopicSubscribeRequest{\n\tCacheName: "test-cache",\n\tTopicName: "test-topic",\n})\nif subErr != nil {\n\tpanic(subErr)\n}\n\ntime.Sleep(time.Second)\n_, pubErr := client.Publish(ctx, &momento.TopicPublishRequest{\n\tCacheName: "test-cache",\n\tTopicName: "test-topic",\n\tValue:     momento.String("test-message"),\n})\nif pubErr != nil {\n\tpanic(pubErr)\n}\ntime.Sleep(time.Second)\n\nitem, err := sub.Item(ctx)\nif err != nil {\n\tpanic(err)\n}\nswitch msg := item.(type) {\ncase momento.String:\n\tfmt.Printf("received message as string: \'%v\'\\n", msg)\ncase momento.Bytes:\n\tfmt.Printf("received message as bytes: \'%v\'\\n", msg)\n}',csharp:'var produceCancellation = new CancellationTokenSource();\nproduceCancellation.CancelAfter(2000);\n\nvar subscribeResponse = await topicClient.SubscribeAsync("test-cache", "test-topic");\nswitch (subscribeResponse)\n{\n    case TopicSubscribeResponse.Subscription subscription:\n        var cancellableSubscription = subscription.WithCancellation(produceCancellation.Token);\n\n        await Task.Delay(1_000);\n        await topicClient.PublishAsync("test-cache", "test-topic", "test-topic-value");\n        await Task.Delay(1_000);\n\n        await foreach (var message in cancellableSubscription)\n        {\n            switch (message)\n            {\n                case TopicMessage.Binary:\n                    Console.WriteLine("Received unexpected binary message from topic.");\n                    break;\n                case TopicMessage.Text text:\n                    Console.WriteLine($"Received string message from topic: {text.Value}");\n                    break;\n                case TopicMessage.Error error:\n                    throw new Exception($"An error occurred while receiving topic message: {error.ErrorCode}: {error}");\n                default:\n                    throw new Exception("Bad message received");\n            }\n        }\n        subscription.Dispose();\n        break;\n    case TopicSubscribeResponse.Error error:\n        throw new Exception($"An error occurred subscribing to a topic: {error.ErrorCode}: {error}");\n}\n',php:"",rust:"",ruby:"",elixir:"",cli:"",mdxType:"SdkExampleTabsImpl"}),(0,r.kt)("h3",{id:"publish"},"Publish"),(0,r.kt)("p",null,"Publishes a message to a topic."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cacheName"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the cache where the topic exists.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"topicName"),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Name of the topic to publish the value to.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"value"),(0,r.kt)("td",{parentName:"tr",align:null},"String / bytes"),(0,r.kt)("td",{parentName:"tr",align:null},"Value to publish to the topic.")))),(0,r.kt)(m,{mdxType:"Tabs"},(0,r.kt)(b,{value:"golang",label:"Go",default:!0,mdxType:"TabItem"},"This is ",(0,r.kt)("a",{href:"https://github.com/momentohq/client-sdk-go/blob/main/examples/pubsub-example/main.go#L95"},"example code"),"."),(0,r.kt)(b,{value:"nodejs",label:"Node.js",default:!0,mdxType:"TabItem"},"Coming soon.")),(0,r.kt)("details",null,(0,r.kt)("summary",null,"Method response object"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Success"),(0,r.kt)("li",{parentName:"ul"},"Error")),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/topics/develop/api-reference/response-objects"},"response objects")," for specific information.")),(0,r.kt)(i.X,{js:"const result = await topicClient.publish('test-cache', 'test-topic', 'test-topic-value');\nif (result instanceof TopicPublish.Success) {\n  console.log(\"Value published to topic 'test-topic'\");\n} else if (result instanceof TopicPublish.Error) {\n  throw new Error(\n    `An error occurred while attempting to publish to the topic 'test-topic' in cache 'test-cache': ${result.errorCode()}: ${result.toString()}`\n  );\n}",python:'response = await topic_client.publish("cache", "my_topic", "my_value")\nmatch response:\n    case TopicPublish.Success():\n        print("Successfully published a message")\n    case TopicPublish.Error():\n        print("Error publishing a message: ", response.message)',java:"",go:'_, err := client.Publish(ctx, &momento.TopicPublishRequest{\n\tCacheName: "test-cache",\n\tTopicName: "test-topic",\n\tValue:     momento.String("test-message"),\n})\nif err != nil {\n\tpanic(err)\n}',csharp:'ar publishResponse =\n    await topicClient.PublishAsync("test-cache", "test-topic", "test-topic-value");\nswitch (publishResponse)\n{\n    case TopicPublishResponse.Success:\n        Console.WriteLine("Successfully published message to \'test-topic\'");\n        break;\n    case TopicPublishResponse.Error error:\n        throw new Exception($"An error occurred while publishing topic message: {error.ErrorCode}: {error}");\n}\n',php:"",rust:"",ruby:"",elixir:"",cli:"",mdxType:"SdkExampleTabsImpl"}),(0,r.kt)("h2",{id:"topicclient"},"TopicClient"),(0,r.kt)("p",null,"Instead of the CacheClient, as used in most Momento Cache API calls, for Topics you use a TopicClient object."),(0,r.kt)(i.X,{js:"new TopicClient({\n  configuration: TopicConfigurations.Default.latest(),\n  credentialProvider: CredentialProvider.fromEnvironmentVariable({\n    environmentVariableName: 'MOMENTO_API_KEY',\n  }),\n});",python:'topic_client = TopicClientAsync(\n    TopicConfigurations.Default.latest(),\n    CredentialProvider.from_environment_variable("MOMENTO_AUTH_TOKEN")\n)',java:"",go:'credProvider, err := auth.NewEnvMomentoTokenProvider("MOMENTO_API_KEY")\nif err != nil {\n\tpanic(err)\n}\n\ntopicClient, err := momento.NewTopicClient(\n\tconfig.TopicsDefault(),\n\tcredProvider,\n)\nif err != nil {\n\tpanic(err)\n}',csharp:'new TopicClient(\n    TopicConfigurations.Laptop.latest(), \n    new EnvMomentoTokenProvider("MOMENTO_AUTH_TOKEN")\n);\n',php:"",rust:"",ruby:"",elixir:"",cli:"",mdxType:"SdkExampleTabsImpl"}),(0,r.kt)("h2",{id:"example-apps-using-momento-topics-apis"},"Example apps using Momento Topics APIs"),(0,r.kt)("p",null,"A growing list of example apps using the Momento Topics."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/momentohq/client-sdk-javascript/tree/main/examples/nodejs/lambda-examples/topics-microservice"},"A serverless item publishing microservice")," This microservice is written in TypeScript and runs on AWS using API Gateway, a Lambda function, and Momento Topics. It can be used by any of your other services (with the correct security on API Gateway) to publish messages to various topics that are then subscribed to by other applications. You pass into this API a ",(0,r.kt)("inlineCode",{parentName:"li"},"topicName")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"topicValue")," and this service publishes the value to that topic.")))}h.isMDXComponent=!0}}]);